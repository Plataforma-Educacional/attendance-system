datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider      = "prisma-client-js"
  binaryTargets = "native"
}

model User {
  id           Int           @id @default(autoincrement())
  email        String        @unique
  name         String
  display_name String?
  role         Role          @relation(fields: [role_id], references: [id])
  role_id      Int
  chat_member  Chat_Member[]
  Message      Message[]
}

model Role {
  id          Int     @id @default(autoincrement())
  name        String?
  permissions Json?
  user        User[]
}

model Chat {
  id           Int            @id @default(autoincrement())
  status       Int
  created_at   DateTime       @default(now())
  updated_at   DateTime
  chat_member  Chat_Member[]
  Chat_Message Chat_Message[]
}

model Chat_Message {
  id         Int     @id @default(autoincrement())
  message    Message @relation(fields: [message_id], references: [id])
  chat       Chat    @relation(fields: [chat_id], references: [id])
  message_id Int
  chat_id    Int
}

model Message {
  id           Int            @id @default(autoincrement())
  body         String
  created_at   DateTime       @default(now())
  updated_at   DateTime
  author       User           @relation(fields: [user_id], references: [id])
  user_id      Int
  Chat_Message Chat_Message[]
}

model Chat_Member {
  id      Int  @id @default(autoincrement())
  author  User @relation(fields: [user_id], references: [id])
  chat    Chat @relation(fields: [chat_id], references: [id])
  user_id Int
  chat_id Int
}
